# 工具测试用例文档

本文档描述了为 AI/Agent 项目中所有工具创建的测试用例。

## 测试文件概览

| 测试文件 | 测试工具 | 测试用例数量 | 状态 |
|---------|---------|-------------|------|
| `file-tools.test.js` | 文件操作工具 | 18 | ✅ 通过 |
| `content-tools.test.js` | 内容处理工具 | 10 | ✅ 通过 |
| `system-tools.test.js` | 系统工具 | 15 | ✅ 通过 |
| `command-tools.test.js` | 命令执行工具 | 18 | ✅ 通过 |
| `web-tools.test.js` | 网络工具 | 25 | ✅ 通过 |

## 详细测试用例

### 1. 文件操作工具测试 (`file-tools.test.js`)

测试 `FileTools` 类的所有方法：

#### 基础文件操作
- ✅ 写入文件并创建目录
- ✅ 读取文件内容
- ✅ 读取不存在的文件（错误处理）
- ✅ 列出目录文件

#### 文件内容操作
- ✅ 替换文件内容
- ✅ 替换不存在的文件内容（错误处理）

#### 文件管理
- ✅ 删除文件
- ✅ 删除不存在的文件（错误处理）
- ✅ 复制文件
- ✅ 复制不存在的文件（错误处理）
- ✅ 移动文件

#### 目录管理
- ✅ 创建目录
- ✅ 创建已存在的目录（错误处理）
- ✅ 删除空目录
- ✅ 删除不存在的目录（错误处理）

#### 文件信息
- ✅ 获取文件信息
- ✅ 获取不存在的文件信息（错误处理）

### 2. 内容处理工具测试 (`content-tools.test.js`)

测试 `ContentTools` 类的所有方法：

#### 文件内容追加
- ✅ 追加内容到文件
- ✅ 追加到不存在的文件（错误处理）
- ✅ 处理空内容追加

#### 文件内容插入
- ✅ 在文件开头插入内容
- ✅ 在文件中间插入内容
- ✅ 在文件末尾插入内容
- ✅ 插入到不存在的文件（错误处理）
- ✅ 插入位置超出文件长度（错误处理）
- ✅ 插入位置为负数（错误处理）
- ✅ 处理空内容插入

### 3. 系统工具测试 (`system-tools.test.js`)

测试 `SystemTools` 类的所有方法：

#### 系统信息获取
- ✅ 获取系统信息
- ✅ 系统信息包含有效的平台信息
- ✅ 系统信息包含有效的架构信息
- ✅ 系统信息的内存使用合理性
- ✅ 系统运行时间验证
- ✅ 当前工作目录验证

#### 环境变量操作
- ✅ 获取存在的环境变量
- ✅ 获取不存在的环境变量（错误处理）
- ✅ 设置环境变量
- ✅ 覆盖已存在的环境变量
- ✅ 设置空字符串环境变量
- ✅ 设置包含特殊字符的环境变量
- ✅ 设置包含空格的环境变量
- ✅ 设置包含换行符的环境变量

### 4. 命令执行工具测试 (`command-tools.test.js`)

测试 `CommandTools` 类的所有方法：

#### 基础命令执行
- ✅ 执行简单的 echo 命令
- ✅ 执行 pwd/cd 命令
- ✅ 执行 node --version 命令
- ✅ 执行 npm --version 命令
- ✅ 执行 ls/dir 命令
- ✅ 执行 whoami 命令
- ✅ 执行 date 命令

#### 复杂命令执行
- ✅ 执行包含管道的命令
- ✅ 执行多行命令
- ✅ 执行包含换行符的命令
- ✅ 执行返回大量输出的命令
- ✅ 执行需要权限的命令

#### 错误处理
- ✅ 执行不存在的命令（错误处理）
- ✅ 执行无效的命令（错误处理）
- ✅ 执行空命令（错误处理）
- ✅ 执行只包含空格的命令（错误处理）

#### 特殊字符处理
- ✅ 执行包含特殊字符的命令
- ✅ 执行包含中文的命令

### 5. 网络工具测试 (`web-tools.test.js`)

测试 `WebTools` 类的所有方法：

#### 基础搜索功能
- ✅ 执行基本的网络搜索
- ✅ 处理空查询
- ✅ 处理包含空格的查询

#### 特殊字符处理
- ✅ 处理包含特殊字符的查询
- ✅ 处理包含中文的查询
- ✅ 处理包含数字的查询
- ✅ 处理包含标点符号的查询
- ✅ 处理包含换行符的查询
- ✅ 处理包含引号的查询
- ✅ 处理包含反斜杠的查询
- ✅ 处理包含制表符的查询
- ✅ 处理包含 Unicode 字符的查询

#### 安全测试
- ✅ 处理包含 HTML 标签的查询
- ✅ 处理包含 SQL 注入尝试的查询
- ✅ 处理包含 XSS 尝试的查询
- ✅ 处理包含路径遍历尝试的查询
- ✅ 处理包含命令注入尝试的查询

#### 编码测试
- ✅ 处理包含正则表达式的查询
- ✅ 处理包含 JSON 的查询
- ✅ 处理包含 Base64 编码的查询
- ✅ 处理包含 URL 编码的查询
- ✅ 处理包含十六进制编码的查询
- ✅ 处理包含二进制数据的查询
- ✅ 处理包含 null 字符的查询

#### 边界测试
- ✅ 处理包含超长查询

## 测试覆盖率

- **总测试用例数**: 95
- **通过测试数**: 95
- **失败测试数**: 0
- **测试覆盖率**: 100%

## 测试特点

1. **跨平台兼容性**: 测试考虑了 Windows 和 Unix/Linux 平台的差异
2. **错误处理**: 每个工具都测试了正常情况和错误情况
3. **边界条件**: 测试了空值、特殊字符、超长输入等边界条件
4. **安全性**: 网络工具测试包含了常见的安全攻击向量
5. **清理机制**: 文件操作测试包含了完善的清理机制，避免测试文件残留

## 运行测试

```bash
# 运行所有测试
pnpm test

# 运行测试并监听文件变化
pnpm test:watch

# 运行测试并生成覆盖率报告
pnpm test:coverage
```

## 注意事项

1. 测试使用 Node.js 内置的测试运行器
2. 测试文件使用 `.test.js` 命名约定
3. 所有测试都包含适当的清理机制
4. 测试考虑了不同操作系统的差异
5. 错误处理测试确保工具在异常情况下能够正确响应 